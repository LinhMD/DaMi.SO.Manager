@inherits XComponent<OrderMasterEditModel>
@inject IStringLocalizer<ShareResource> L

<div class="row">
    <div class="col-xl-6 col-xxl-12">
        <div class="card">
            <h4 class="card-header text-bold">@L["Thông tin đơn hàng"]</h4>
            <hr />
            <div class="card-body">
                <div class="basic-form">
                    <div class="form-group row">
                        <label for="OrderFormId" class="col-form-label col-2">@L["Kiểu đơn hàng"]</label>
                        <div class="col-sm-10">
                            <select name="OrderFormId" class="form-control selectpicker" id="OrderFormId"
                                value="@Model.OrderMaster.OrderFormId">
                                @foreach (var orderFrom in Model.OrderForms)
                                {
                                    <option value="@orderFrom.OrderFormId">@orderFrom.OrderFormName</option>
                                }
                            </select>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="OrderTypeId" class="col-form-label col-2">@L["Loại đơn hàng"]</label>
                        <div class="col-sm-10">
                            <select name="OrderTypeId" class="form-control selectpicker" id="OrderTypeId"
                                value="@Model.OrderMaster.OrderTypeId">
                                @foreach (var orderType in Model.OrderTypes)
                                {
                                    <option value="@orderType.OrderTypeId">@orderType.OrderTypeName</option>
                                }
                            </select>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="Guid" class="col-form-label col-2">@L["Số đơn hàng"]</label>
                        <div class="col-sm-10">
                            <input id="Guid" name="OrderNo" class="form-control" disabled
                                value="@Model.OrderMaster.OrderNo">
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="OrderDate" class="col-form-label col-2">@L["Ngày tạo"]</label>
                        <div class="col-sm-10">
                            <input id="OrderDate" data-provide="datepicker" disabled type="date" name="OrderDate"
                                value="@(Model.OrderMaster.OrderDate?.ToString("yyyy-MM-dd") ?? DateTime.Now.ToString("yyyy-MM-dd"))"
                                class="form-control">
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="OrderStatusId" class="col-form-label col-2">@L["Trạng thái ĐH"]</label>
                        <div class="col-sm-10">
                            <select name="OrderStatusId" class="form-control selectpicker" disabled id="OrderStatusId"
                                value="@Model.OrderMaster.OrderStatusId">
                                @foreach (var orderStatus in Model.OrderStatuses)
                                {
                                    if (orderStatus.OrderStatusId == Model.OrderMaster.OrderStatusId)
                                    {
                                        <option value="@orderStatus.OrderStatusId" selected>@orderStatus.OrderStatusName
                                        </option>
                                    }
                                    else
                                    {
                                        <option value="@orderStatus.OrderStatusId">@orderStatus.OrderStatusName</option>
                                    }
                                }
                            </select>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-xl-6 col-xxl-12">
        <div class="card">
            <h4 class="card-header text-bold">@L["Thông tin khác"]</h4>
            <hr />
            <div class="card-body">
                <div class="basic-form">
                    <div class="form-group row">
                        <label for="ExecutorId" class="col-form-label col-3">@L["Nhân viên triển khai"]</label>
                        <div class="col-sm-9">
                            <select class="form-control selectpicker" id="ExecutorId" name="ExecutorId"
                                @bind="Model.OrderMaster.ExecutorId">
                                @foreach (var employee in Model.Employees.Where(e => e.Department.IsInstall))
                                {
                                    if (employee.EmployeeId == Model.OrderMaster.ExecutorId)
                                    {
                                        <option value="@employee.EmployeeId" selected> @employee.EmployeeName</option>
                                    }
                                    else
                                    {
                                        <option value="@employee.EmployeeId">@employee.EmployeeName</option>
                                    }
                                }
                            </select>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="BeginExecDate" class="col-form-label col-3">@L["Ngày BĐ triển khai"]</label>
                        <div class="col-sm-9">
                            <input id="BeginExecDate" class="form-control" data-provide="datepicker"
                                name="BeginExecDate" type="date" value="@Model.OrderMaster.BeginExecDate">
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="EndExecDate" class="col-form-label col-3">@L["Ngày KT triển khai"]</label>
                        <div class="col-sm-9">
                            <input id="EndExecDate" class="form-control" data-provide="datepicker" type="date"
                                name="EndExecDate" value="@Model.OrderMaster.EndExecDate">
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="SalesManId" class="col-form-label col-3">@L["Nhân viên bán hàng"]</label>
                        <div class="col-sm-9">
                            <select class="form-control selectpicker" id="SalesManId" disabled name="SalesManId"
                                value="@Model.OrderMaster.SalesManId">
                                @foreach (var employee in Model.Employees)
                                {
                                    if (employee.EmployeeId == Model.OrderMaster.SalesManId)
                                    {
                                        <option value="@employee.EmployeeId" selected> @employee.EmployeeName</option>
                                    }
                                    else
                                    {
                                        <option value="@employee.EmployeeId">@employee.EmployeeName</option>
                                    }
                                }
                            </select>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="SalesManId" class="col-form-label col-3"></label>
                        <div class="col-sm-9">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-xl-6 col-xxl-12">
        <div class="card">
            <h4 class="card-header">@L["Thông tin hợp đồng"]</h4>
            <hr>
            <div class="card-body">
                <div class="basic-form">
                    <div class="form-group row">
                        <label for="CustomerId" class="col-form-label col-2">
                            @L["Tên KH"]
                            <span class="mdi mdi-reload hx-indicator"></span>
                        </label>
                        <div class="col-sm-10">
                            <input type="hidden" id="CustomerId" name="CustomerId">
                            <select class="form-control selectpicker" hx-indicator=".hx-indicator"
                                hx-get="/OrderMaster/Edit/Customer" id="CustomerIdSelect" name="CustomerIdSelect"
                                value="@Model.OrderMaster.CustomerId">
                                <option></option>
                                @foreach (var customer in Model.Customers)
                                {
                                    <option value="@customer.CustomerId">@customer.CustomerName</option>
                                }
                            </select>
                            <script>
                                var select = new SlimSelect({
                                    select: '#CustomerIdSelect',
                                    events: {
                                        afterChange: (newVal) => {
                                            console.log(newVal);
                                            $("#CustomerId").val(newVal[0]?.value ?? "");
                                        }
                                    }
                                });
                            </script>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="CustomerTax" class="col-form-label col-2">
                            @L["MST/CCCD"]
                            <span class="mdi mdi-reload hx-indicator"></span>
                        </label>
                        <div class="col-sm-10">
                            <input id="CustomerTax" disabled class="form-control" value="@Model.OrderMaster.TaxCode">
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="CustomerPhone" class="col-form-label col-2">
                            @L["Điện thoại"]
                            <span class="mdi mdi-reload customer-info"></span>
                        </label>
                        <div class="col-sm-10">
                            <input id="CustomerPhone" name="Phone" class="form-control"
                                value="@Model.OrderMaster.Phone">
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="RefPerson" class="col-form-label col-2">
                            @L["Người đại điện"]
                        </label>
                        <div class="col-sm-10">
                            <input id="RefPerson" name="RefPerson" class="form-control"
                                value="@Model.OrderMaster.RefPerson">
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="RefPos" class="col-form-label col-2">
                            @L["Chức vụ"]
                        </label>
                        <div class="col-sm-10">
                            <input id="RefPos" name="RefPos" class="form-control" value="@Model.OrderMaster.RefPos">
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="ContractNo" class="col-form-label col-2">
                            @L["Số hợp đồng"]
                        </label>
                        <div class="col-sm-10">
                            <input id="ContractNo" name="ContractNo" class="form-control"
                                value="@Model.OrderMaster.ContractNo">
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="ContractDate" class="col-form-label col-2">
                            @L["Ngày hợp đồng"]
                        </label>
                        <div class="col-sm-10">
                            <input id="ContractDate" name="ContractDate" data-provide="datepicker" type="date"
                                class="form-control" value="@Model.OrderMaster.ContractDate">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-xl-6 col-xxl-12">
        <div class="card">
            <h4 class="card-header text-bold"> @L["Thông tin thanh toán"]</h4>
            <hr>
            <div class="card-body">
                <div class="basic-form">
                    <div class="form-group row">
                        <label for="CurrencyId" class="col-form-label col-3"> @L["Loại tiền"]</label>
                        <div class="col-sm-9">
                            <select class="form-control selectpicker" id="CurrencyId" name="CurrencyId"
                                value="@Model.OrderMaster.CurrencyId">
                                @foreach (var currency in Model.Currencies)
                                {
                                    if (currency.CurrencyId == Model.OrderMaster.CurrencyId)
                                    {
                                        <option value="@currency.CurrencyId" selected>@currency.CurrencyName</option>
                                    }
                                    else
                                    {
                                        <option value="@currency.CurrencyId">@currency.CurrencyName</option>
                                    }
                                }
                            </select>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="ExchangeRate" class="col-form-label col-3"> @L["Tỉ giá"]</label>
                        <div class="col-sm-9">
                            <input id="ExchangeRate" name="ExchangeRate" class="form-control"
                                value="@Model.OrderMaster.ExchangeRate">
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="OriginalTotalAmount" class="col-form-label col-3"> @L["Cộng thành tiền"]</label>
                        <div class="col-sm-9">
                            <input id="OriginalTotalAmount" name="OriginalTotalAmount" class="form-control"
                                value="@Model.OrderMaster.ConvertTotalAmount">
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="ConvertDiscAmount" class="col-form-label col-3"> @L["Cộng tiền CK"]</label>
                        <div class="col-sm-9">
                            <input id="ConvertDiscAmount" name="ConvertDiscAmount" class="form-control"
                                value="@Model.OrderMaster.ConvertDiscAmount">
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="TotalAmount" class="col-form-label col-3"> @L["Tổng tiền thanh toán"]</label>
                        <div class="col-sm-9">
                            <input id="TotalAmount" name="TotalAmount" class="form-control"
                                value="@Model.OrderMaster.TotalAmount">
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="OverDate" class="col-form-label col-3"> @L["Hạn thanh toán"]</label>
                        <div class="col-sm-9">
                            <input id="OverDate" name="OverDate" data-provide="datepicker" type="date"
                                class="form-control" value="@Model.OrderMaster.OverDate">
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="PublishedInvoice" class="col-form-label col-3"> @L["Có xuất hóa đơn"]</label>
                        <div class="col-sm-9">
                            @if (Model.OrderMaster.HasInvoiceVat ?? false)
                            {
                                <input type="checkbox" id="HasInvoiceVat" value="true" name="HasInvoiceVat"
                                    class="form-control" checked>
                            }
                            else
                            {
                                <input type="checkbox" id="HasInvoiceVat" name="HasInvoiceVat" class="form-control"
                                    value="false">
                            }
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="PaymentMethodId" class="col-form-label col-3"> @L["Hình thức thanh toán"]</label>
                        <div class="col-sm-9">
                            <select class="form-control selectpicker" id="PaymentMethodId" name="PaymentMethodId"
                                value="@Model.OrderMaster.CurrencyId">
                                @foreach (var paymentMethod in Model.PaymentMethods)
                                {
                                    if (paymentMethod.PaymentMethodId == Model.OrderMaster.PaymentMethodId)
                                    {
                                        <option value="@paymentMethod.PaymentMethodId" selected>@paymentMethod.PaymentMethodName
                                        </option>
                                    }
                                    else
                                    {
                                        <option value="@paymentMethod.PaymentMethodId">@paymentMethod.PaymentMethodName</option>
                                    }
                                }
                            </select>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="PaymentTerms" class="col-form-label col-3"> @L["Điều khoản thanh toán"]</label>
                        <div class="col-sm-9">
                            <input type="text" id="PaymentTerms" name="PaymentTerms" class="form-control"
                                value="@Model.OrderMaster.PaymentTerms">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-xl-6 col-xxl-12">
        <div class="card">
            <h4 class="card-header">Điễn giãi</h4>
            <hr>
            <div class="card-body">
                <div class="form-group">
                    <textarea type="text" class="form-control" id="Description" name="Description"
                        rows="6">@Model.OrderMaster.Description</textarea>
                </div>
            </div>
        </div>
    </div>
    <div class="col-xl-6 col-xxl-12">
        <div class="card">
            <h4 class="card-header ">Ghi Chú</h4>
            <hr>
            <div class="card-body">
                <div class="form-group">
                    <textarea type="text" class="form-control" id="Notes" name="Notes"
                        rows="6">@Model.OrderMaster.Notes</textarea>
                </div>
            </div>
        </div>
    </div>
</div>